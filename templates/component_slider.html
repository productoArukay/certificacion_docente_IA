<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Componente – Control deslizante</title>
  <style>
    :root{
      --accent:#e45700ff; /* corporativo */
      --ink:#434343;      /* títulos */
      --muted:#666666;    /* párrafos */
      --teal:#0a7a84;     /* perilla */
      --bar-bg:#eeeeee;
    }
    *{box-sizing:border-box}
    body{ margin:0; background:#fff; }

    /* ---- Contenedor requerido ---- */
    .comp-wrap{
      width:90%;
      height:500px;
      margin:16px auto;
      border:1px solid #e9e9e9;
      border-radius:12px;
      overflow:hidden;
      display:grid;
      grid-template-rows: auto 1fr 8px;
      grid-template-areas:
        "head"
        "content"
        "prog";
      background:#fff;
      box-shadow: 0 4px 18px rgba(0,0,0,.06);
    }

    header{
      grid-area:head;
      padding:16px 20px 0 20px;
      background:#efefef70;
    }
    h1{
      margin:0 0 8px;
      font:700 26px Arial, Helvetica, sans-serif; color:var(--ink);
    }
    p.desc{
      margin:0 0 14px;
      font:400 12px "Proxima Nova","ProximaNova",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      color:var(--muted); line-height:1.6;
    }
    .prompt{
      font:700 14px Arial, Helvetica, sans-serif;
      color:var(--accent);
      margin:8px 0 10px;
    }

    .content{
      grid-area:content;
      height:100%; overflow:auto;
      padding:0 18px 16px;
    }

    /* Escala con marcas 1-10 */
    .scale{
      position:relative;
      margin:8px 0 16px;
      padding-top:20px;
      border-bottom:3px solid #333;
      height:48px;
    }
    .tick{
      position:absolute; bottom:-3px;
      width:2px; height:10px; background:#333;
      transform:translateX(-50%);
    }
    .num{
      position:absolute; top:0; transform:translateX(-50%);
      font:400 12px Arial, Helvetica, sans-serif; color:#2f3136;
    }
    .bubble{
      position:absolute; left:0; top:-22px;
      transform:translateX(-50%);
      background:#0a7a84; color:#fff; border-radius:16px; padding:4px 10px;
      font:700 14px Arial;
      box-shadow:0 2px 8px rgba(0,0,0,.2);
    }

    /* Slider nativo estilizado */
    .slider-wrap{ margin:12px 0 16px; }
    input[type="range"]{
      -webkit-appearance:none; appearance:none;
      width:100%; height:14px; border-radius:7px; background:#f2f3f5; outline:none;
      box-shadow: inset 0 2px 3px rgba(0,0,0,.08);
    }
    input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none;
      width:28px; height:28px; border-radius:50%;
      background:var(--teal); border:0; cursor:pointer;
      box-shadow:0 3px 10px rgba(0,0,0,.25);
      margin-top:-7px;
    }
    input[type="range"]::-moz-range-thumb{
      width:28px; height:28px; border-radius:50%;
      background:var(--teal); border:0; cursor:pointer;
      box-shadow:0 3px 10px rgba(0,0,0,.25);
    }

    /* Acciones y feedback */
    .actions{ display:flex; gap:12px; margin-top:10px; }
    .btn{
      border:0; border-radius:2px;
      padding:12px 16px;
      font:700 14px Arial, Helvetica, sans-serif;
      cursor:pointer; color:#fff; background:#4b4e51;
    }
    .btn.secondary{ background:#7a7c80; }

    .feedback{
      margin:14px 0 0;
      display:none;
      border-radius:6px;
      border:1px solid #e4e6ea;
      background:#fafafa;
      padding:10px 12px;
      font:400 12px "Proxima Nova","ProximaNova",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      color:var(--muted);
      line-height:1.6;
    }
    .feedback.correct{ border-color:#10b98155; box-shadow: inset 0 0 0 2px #10b98133; }
    .feedback.incorrect{ border-color:#ef444455; box-shadow: inset 0 0 0 2px #ef444433; }

    /* Barra de progreso */
    .progress{ grid-area:prog; height:8px; background:var(--bar-bg); position:relative; }
    .progress .bar{ position:absolute; inset:0 auto 0 0; width:0%; background:var(--accent); transition:width .25s ease; }
  </style>
</head>
<body>
  <!-- Cambia el id para identificar este HTML en tu orquestador -->
  <section class="comp-wrap" data-component-id="slider-001" data-correct="7">
    <header>
      <h1>Control deslizante</h1>
      <p class="desc">Se cree que la memoria de trabajo es responsable de nuestra capacidad de retener y manipular información temporalmente, pero según Miller (1956), ¿qué “número mágico” describe su capacidad?</p>
      <div class="prompt">Arrastre el control deslizante para hacer su elección y seleccione Enviar.</div>
    </header>

    <div class="content">
      <div class="scale" id="scale">
        <div class="bubble" id="bubble">1</div>
        <!-- ticks y números 1–10 -->
      </div>

      <div class="slider-wrap" aria-label="Selecciona un número del 1 al 10">
        <input id="range" type="range" min="1" max="10" step="1" value="1" />
      </div>

      <div class="actions">
        <button class="btn" id="submit">Entregar</button>
        <button class="btn secondary" id="show">Mostrar comentarios</button>
      </div>

      <div class="feedback" id="feedback"></div>
    </div>

    <div class="progress" aria-hidden="true"><div class="bar" id="bar"></div></div>
  </section>

  <script>
    (function(){
      const wrap = document.querySelector('.comp-wrap');
      const id = wrap.getAttribute('data-component-id') || 'slider-component';
      const correct = parseInt(wrap.getAttribute('data-correct') || '7', 10);
      const scale = document.getElementById('scale');
      const bubble = document.getElementById('bubble');
      const range = document.getElementById('range');
      const submit = document.getElementById('submit');
      const show = document.getElementById('show');
      const feedback = document.getElementById('feedback');
      const bar = document.getElementById('bar');

      let moved = false, submitted = false;

      // Crear marcas 1–10
      for(let i=1;i<=10;i++){
        const tick = document.createElement('div');
        tick.className='tick';
        tick.style.left = ((i-1)/9*100) + '%';
        scale.appendChild(tick);

        const num = document.createElement('div');
        num.className='num';
        num.style.left = ((i-1)/9*100) + '%';
        num.textContent = i;
        scale.appendChild(num);
      }

      function post(pct){
        try{
          window.parent && window.parent.postMessage({
            type:'componentProgress',
            componentId:id,
            progress:pct,
            completed: pct >= 95
          }, '*');
        }catch(e){}
      }

      function setBubble(){
        const val = parseInt(range.value,10);
        const pct = (val-1)/9;
        bubble.textContent = val;
        bubble.style.left = (pct*100) + '%';
      }

      function updateProgress(){
        if(submitted){ bar.style.width = '100%'; post(100); return; }
        const pct = moved ? 60 : 0;
        bar.style.width = pct + '%'; post(pct);
      }

      range.addEventListener('input', ()=>{ moved = true; setBubble(); updateProgress(); });

      function grade(){
        submitted = true;
        const val = parseInt(range.value,10);
        feedback.style.display='block';
        if(val === correct){
          feedback.className='feedback correct';
          feedback.textContent='¡Correcto! El número mágico de Miller es 7 (±2).';
        }else{
          feedback.className='feedback incorrect';
          feedback.textContent='No es correcto. Respuesta esperada: 7.';
        }
        updateProgress();
      }

      submit.addEventListener('click', grade);
      show.addEventListener('click', ()=>{
        feedback.style.display='block';
        feedback.className='feedback';
        feedback.textContent='Pista/Comentario: Miller propuso 7 como el “número mágico” asociado a la capacidad de la memoria de trabajo.';
      });

      // API simple
      window.SliderQ = {
        setTitle(t){ document.querySelector('h1').textContent=t; },
        setDesc(html){ document.querySelector('.desc').innerHTML=html; },
        setCorrect(n){ wrap.setAttribute('data-correct', String(n)); },
        setRange(min,max,step,initial){ range.min=min; range.max=max; range.step=step; range.value=initial; moved=false; submitted=false; bar.style.width='0%'; setBubble(); post(0); }
      };

      // Inicial
      setBubble(); updateProgress();
    })();
  </script>
</body>
</html>

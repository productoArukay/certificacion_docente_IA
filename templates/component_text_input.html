<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Componente – Entrada de texto</title>
  <style>
    :root{
      --accent:#e45700ff; /* corporativo */
      --ink:#434343;      /* títulos */
      --muted:#666666;    /* párrafos */
      --teal:#0a7a84;     /* contorno input */
      --bar-bg:#eeeeee;
    }
    *{box-sizing:border-box}
    body{ margin:0; background:#fff; }

    /* ---- Contenedor requerido ---- */
    .comp-wrap{
      width:90%;
      height:500px;
      margin:16px auto;
      border:1px solid #e9e9e9;
      border-radius:12px;
      overflow:hidden;
      display:grid;
      grid-template-columns: 1.05fr 1fr;
      grid-template-rows: 1fr 8px;
      grid-template-areas:
        "left right"
        "prog prog";
      background:#fff;
      box-shadow: 0 4px 18px rgba(0,0,0,.06);
    }

    .left{ grid-area:left; padding:22px 22px 16px; overflow:auto; background:#efefef70; }
    .right{ grid-area:right; padding:22px; display:flex; align-items:center; justify-content:center; background:#efefef70; border-left:1px solid #e7e7e7; }

    /* TITULOS y textos */
    h1{
      margin:0 0 8px;
      font:700 26px Arial, Helvetica, sans-serif; color:var(--ink);
    }
    p.desc{
      margin:0 12px 18px 0;
      font:400 12px "Proxima Nova","ProximaNova",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      color:var(--muted); line-height:1.6;
    }
    .prompt{
      font:700 14px Arial, Helvetica, sans-serif;
      color:var(--accent);
      margin:0 0 10px;
    }

    /* Input */
    .input-wrap{ margin:8px 0 16px; }
    input[type="text"]{
      width:100%;
      padding:10px 12px;
      font:400 14px "Proxima Nova","ProximaNova",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      color:#2f3136;
      border:3px solid var(--teal);
      border-radius:2px;
      outline:none;
    }
    input[type="text"]::placeholder{ color:#9aa0a6; }

    /* Botones */
    .actions{ display:flex; gap:10px; }
    .btn{
      border:0; border-radius:2px;
      padding:12px 14px;
      font:700 14px Arial, Helvetica, sans-serif;
      cursor:pointer;
      color:#fff;
      background:#4b4e51;
    }
    .btn.secondary{ background:#7a7c80; }

    /* Feedback */
    .feedback{
      margin-top:12px;
      display:none;
      border-radius:6px;
      border:1px solid #e4e6ea;
      background:#fafafa;
      padding:10px 12px;
      font:400 12px "Proxima Nova","ProximaNova",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      color:var(--muted);
      line-height:1.6;
    }
    .feedback.correct{ border-color:#10b98155; box-shadow: inset 0 0 0 2px #10b98133; }
    .feedback.incorrect{ border-color:#ef444455; box-shadow: inset 0 0 0 2px #ef444433; }

    /* Media placeholder a la derecha */
    .media{
      width:100%; height:100%;
      background:#bfc3c8; border:1px solid #d8dade; border-radius:6px;
      display:flex; align-items:center; justify-content:center;
      color:#fff; font:600 14px Arial;
    }
    .media img, .media iframe, .media video{ max-width:100%; max-height:100%; border:0; border-radius:6px; }

    /* Barra de progreso */
    .progress{ grid-area:prog; height:8px; background:var(--bar-bg); position:relative; }
    .progress .bar{ position:absolute; inset:0 auto 0 0; width:0%; background:var(--accent); transition:width .2s ease; }

    /* Responsive */
    @media (max-width: 900px){
      .comp-wrap{
        grid-template-columns: 1fr;
        grid-template-rows: 1fr 220px 8px;
        grid-template-areas:
          "left"
          "right"
          "prog";
      }
      .right{ border-left:0; border-top:1px solid #e7e7e7; }
    }
  </style>
</head>
<body>
  <!-- Cambia el id para identificar este HTML en tu orquestador -->
  <section class="comp-wrap" data-component-id="textq-001">
    <div class="left">
      <h1>Entrada de texto</h1>
      <p class="desc">¿Puedes nombrar una de las tres empresas que establecieron Adapt como un proyecto de código abierto liderado por la comunidad?</p>

      <div class="prompt">Ingrese su respuesta y seleccione Enviar.</div>

      <div class="input-wrap">
        <input type="text" id="answer" placeholder="Ingrese la respuesta aquí" autocomplete="off" />
      </div>

      <div class="actions">
        <button class="btn" id="submit">Entregar</button>
        <button class="btn secondary" id="show">Mostrar comentarios</button>
      </div>

      <div class="feedback" id="feedback"></div>
    </div>

    <div class="right">
      <div class="media" id="media">Media (imagen/video/iframe opcional)</div>
    </div>

    <div class="progress" aria-hidden="true"><div class="bar" id="bar"></div></div>
  </section>

  <script>
    (function(){
      const wrap = document.querySelector('.comp-wrap');
      const id = wrap.getAttribute('data-component-id') || 'textq-component';
      const input = document.getElementById('answer');
      const submit = document.getElementById('submit');
      const show = document.getElementById('show');
      const feedback = document.getElementById('feedback');
      const bar = document.getElementById('bar');

      // Lista de respuestas válidas (edita)
      let valid = ['Kineo','Learning Pool','Learning Technologies Group','LTG','Kineo Group'];

      let typed = false, submitted = false;

      function post(pct){
        try{
          window.parent && window.parent.postMessage({
            type:'componentProgress',
            componentId:id,
            progress:pct,
            completed: pct >= 95
          }, '*');
        }catch(e){}
      }
      function updateProgress(){
        if(submitted){ bar.style.width = '100%'; post(100); return; }
        const pct = typed ? 50 : 0;
        bar.style.width = pct + '%'; post(pct);
      }

      input.addEventListener('input', ()=>{
        typed = input.value.trim().length > 0;
        updateProgress();
      });

      function normalize(s){ return s.trim().toLowerCase().replace(/\s+/g,' '); }

      function grade(){
        if(!typed){
          feedback.style.display='block'; feedback.className='feedback incorrect';
          feedback.textContent='Escribe una respuesta antes de enviar.'; return;
        }
        submitted = true;
        const ans = normalize(input.value);
        const ok = valid.some(v => normalize(v) === ans || ans.includes(normalize(v)) || normalize(v).includes(ans));
        feedback.style.display='block';
        if(ok){
          feedback.className='feedback correct';
          feedback.textContent='¡Correcto!';
        }else{
          feedback.className='feedback incorrect';
          feedback.textContent='Respuesta no coincidente. Pistas: ' + valid.slice(0,3).join(', ') + '.';
        }
        updateProgress();
      }

      submit.addEventListener('click', grade);
      show.addEventListener('click', ()=>{
        feedback.style.display='block';
        feedback.className='feedback';
        feedback.textContent='Posibles respuestas: ' + valid.join(', ') + '.';
      });

      // API mínima para reconfigurar desde el padre
      window.TextQ = {
        setTitle(t){ document.querySelector('h1').textContent = t; },
        setPrompt(html){ document.querySelector('.desc').innerHTML = html; },
        setValidAnswers(arr){ valid = Array.isArray(arr) ? arr : valid; },
        setMediaImage(src, alt=''){ const m=document.getElementById('media'); m.innerHTML=''; const img=new Image(); img.src=src; img.alt=alt; m.appendChild(img); },
        setMediaIframe(src, title=''){ const m=document.getElementById('media'); m.innerHTML=''; const f=document.createElement('iframe'); f.src=src; f.title=title; f.loading='lazy'; m.appendChild(f); }
      };

      // Inicial
      updateProgress();
    })();
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Componente – Medios de comunicación</title>
  <style>
    :root{
      --accent:#e45700ff;
      --ink:#434343;      /* Títulos */
      --muted:#666666;    /* Párrafos */
      --bar-bg:#eeeeee;
    }
    *{box-sizing:border-box}
    body{ margin:0; background:#fff; }

    /* ---- Contenedor requerido ---- */
    .comp-wrap{
      width:90%;
      height:500px;
      margin:16px auto;
      border:1px solid #e9e9e9;
      border-radius:12px;
      overflow:hidden;
      display:grid;
      grid-template-rows: auto 1fr auto 8px;
      grid-template-areas:
        "head"
        "media"
        "trans"
        "prog";
      background:#fff;
      box-shadow: 0 4px 18px rgba(0,0,0,.06);
    }

    header{
      grid-area:head;
      padding:16px 20px 0 20px;
    }
    h1{
      margin:0 0 6px;
      font:700 26px Arial, Helvetica, sans-serif;
      color:var(--ink);
    }
    p.intro{
      margin:0 0 10px;
      font:400 12px 'Proxima Nova', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color:var(--muted);
      line-height:1.6;
    }
    p.callout{
      margin:8px 0 14px;
      font:700 14px Arial, Helvetica, sans-serif;
      color:var(--accent);
    }

    /* Media area */
    .media{
      grid-area:media;
      padding:0 18px 12px;
    }
    .player{
      width:100%;
      height:100%;
      background:#c5c7cc;
      border:1px solid #e1e1e1;
      border-radius:6px;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:260px;
    }
    video, audio, iframe{
      width:100%;
      height:100%;
      border:0;
      background:#000;
      display:block;
    }

    /* Transcript */
    .transcript{
      grid-area:trans;
      margin:0 18px 16px;
      border-radius:6px;
      overflow:hidden;
      border:1px solid #dcdcdc;
    }
    .trans-head{
      background:#3a3f46;
      color:#fff;
      padding:10px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      font:700 14px Arial, Helvetica, sans-serif;
      cursor:pointer;
      user-select:none;
    }
    .trans-body{
      display:none;
      padding:12px 14px;
      font:400 12px 'Proxima Nova', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color:var(--muted);
      color:var(--muted);
      background:#fafafa;
      line-height:1.6;
      max-height:140px;
      overflow:auto;
    }
    .transcript.open .trans-body{ display:block; }

    /* Progress bar */
    .progress{ grid-area:prog; height:8px; background:var(--bar-bg); position:relative; }
    .progress .bar{ position:absolute; inset:0 auto 0 0; width:0%; background:var(--accent); transition:width .15s linear; }

  </style>
</head>
<body>
  <!-- Cambia el id para identificar este HTML en tu orquestador -->
  <section class="comp-wrap" data-component-id="media-001">
    <header>
      <h1>Medios de comunicación</h1>
      <p class="intro">A veces necesitamos usar multimedia para enfatizar un punto o simplemente dejar que el audio hable por sí solo. Entonces este componente cobra protagonismo.</p>
      <p class="intro">Este componente puede ser único o extendido.</p>
      <p class="callout">Seleccione el botón de reproducción para iniciar el video.</p>
    </header>

    <div class="media">
      <div class="player">
        <!-- Reemplaza el <video> por un <audio> o <iframe> (YouTube/Vimeo) si prefieres -->
        <video id="mediaEl" controls preload="metadata" poster="">
          <!-- <source src="tu-video.mp4" type="video/mp4" /> -->
          Tu navegador no soporta video HTML5.
        </video>
      </div>
    </div>

    <section class="transcript" id="trans">
      <div class="trans-head" id="tHead">
        Transcripción
        <span id="tIcon" aria-hidden="true">▼</span>
      </div>
      <div class="trans-body" id="tBody">
        <p>Añade aquí la transcripción o subtítulos del contenido multimedia. Mantén frases cortas para facilitar la lectura.</p>
        <p>Puedes sincronizar manualmente párrafos con marcas de tiempo usando enlaces anclados si lo deseas.</p>
      </div>
    </section>

    <div class="progress" aria-hidden="true"><div class="bar" id="bar"></div></div>
  </section>

  <script>
    (function(){
      const wrap = document.querySelector('.comp-wrap');
      const id = wrap.getAttribute('data-component-id') || 'media-component';
      const el = document.getElementById('mediaEl');
      const bar = document.getElementById('bar');
      const trans = document.getElementById('trans');
      const tHead = document.getElementById('tHead');
      const tBody = document.getElementById('tBody');
      const tIcon = document.getElementById('tIcon');

      // Toggle transcript
      tHead.addEventListener('click', ()=>{
        trans.classList.toggle('open');
        tIcon.textContent = trans.classList.contains('open') ? '▲' : '▼';
      });

      // Progress from media timeupdate (prefiere duración del video/audio)
      function tick(){
        const d = el.duration || 0;
        const c = el.currentTime || 0;
        const pct = d > 0 ? Math.min(100, Math.round((c / d) * 100)) : 0;
        bar.style.width = pct + '%';
        post(pct);
      }

      function post(pct){
        try{
          window.parent && window.parent.postMessage({
            type:'componentProgress',
            componentId:id,
            progress:pct,
            completed: pct >= 95
          }, '*');
        }catch(e){}
      }

      ['timeupdate','seeked','playing','pause','loadedmetadata','ended'].forEach(ev=>{
        el.addEventListener(ev, tick);
      });

      // If using iframe (e.g., YouTube), you can manually call window.mediaTick(pct)
      window.mediaTick = function(pct){
        pct = Math.max(0, Math.min(100, Math.round(pct)));
        bar.style.width = pct + '%';
        post(pct);
      };

      // Initial draw
      tick();
    })();
  </script>
</body>
</html>
